<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>JavaScript模块化规范</title>
    <meta name="description" content="Note paper">
    
    
    <link rel="preload" href="/note-paper/assets/css/0.styles.6878c75f.css" as="style"><link rel="preload" href="/note-paper/assets/js/app.163bd82f.js" as="script"><link rel="preload" href="/note-paper/assets/js/2.982b397e.js" as="script"><link rel="preload" href="/note-paper/assets/js/10.1cfc15ca.js" as="script"><link rel="prefetch" href="/note-paper/assets/js/11.bcb96f38.js"><link rel="prefetch" href="/note-paper/assets/js/3.84173f6a.js"><link rel="prefetch" href="/note-paper/assets/js/4.2b9204a9.js"><link rel="prefetch" href="/note-paper/assets/js/5.072bf5b4.js"><link rel="prefetch" href="/note-paper/assets/js/6.d691b9f8.js"><link rel="prefetch" href="/note-paper/assets/js/7.a0f7716c.js"><link rel="prefetch" href="/note-paper/assets/js/8.cda7be00.js"><link rel="prefetch" href="/note-paper/assets/js/9.b88874c6.js">
    <link rel="stylesheet" href="/note-paper/assets/css/0.styles.6878c75f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-navbar"><!----> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><a href="/note-paper/front-end/web-type.html" class="sidebar-link">Web类型</a></li><li><a href="/note-paper/front-end/web-modular.html" class="active sidebar-link">JavaScript模块化规范</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#原始的开发方式" class="sidebar-link">原始的开发方式</a></li><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#commonjs" class="sidebar-link">CommonJS</a></li><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#amd" class="sidebar-link">AMD</a></li><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#cmd" class="sidebar-link">CMD</a></li><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#umd" class="sidebar-link">UMD</a></li><li class="sidebar-sub-header"><a href="/note-paper/front-end/web-modular.html#es6-module" class="sidebar-link">ES6 Module</a></li></ul></li><li><a href="/note-paper/front-end/web-js-framework.html" class="sidebar-link">JavaScript框架</a></li><li><a href="/note-paper/front-end/web-dependencies.html" class="sidebar-link">依赖管理</a></li><li><a href="https://www.webpackjs.com" target="_blank" rel="noopener noreferrer" class="sidebar-link">打包<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="/note-paper/front-end/web-deploy.html" class="sidebar-link">部署</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="page-title"><a href="#page-title" class="header-anchor">#</a> JavaScript模块化规范</h1> <blockquote><p><a href="https://juejin.im/post/5b7d2f45e51d4538826f4c28" target="_blank" rel="noopener noreferrer">AMD , CMD, CommonJS，ES Module，UMD<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <blockquote><p><a href="https://www.cnblogs.com/weiqinl/p/9940549.html" target="_blank" rel="noopener noreferrer">JavaScript模块化CommonJS/AMD/CMD/UMD/ES6Module的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <blockquote><p><a href="http://www.kancloud.cn:8080/chandler/web_technology/387254" target="_blank" rel="noopener noreferrer">javascript模块化之CommonJS、AMD、CMD、UMD、ES6<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <blockquote><p><a href="http://blog.gejiawen.com/2015/11/03/what-is-amd-cmd-commonjs-umd/" target="_blank" rel="noopener noreferrer">关于AMD,CMD,CommonJS及UMD规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <ul><li><p>作用:</p> <p><strong>规范JavaScript的模块定义和加载机制，降低了学习和使用各种框架的门槛，能够以一种统一的方式去定义和使用模块，提高开发效率，降低了应用维护成本。</strong></p></li> <li><p>模块化进程</p> <p><strong>原始的开发方式 -&gt; CommonJS -&gt; AMD -&gt; CMD -&gt; UMD -&gt; ES6 Module</strong></p></li></ul> <h2 id="原始的开发方式"><a href="#原始的开发方式" class="header-anchor">#</a> 原始的开发方式</h2> <p>JavaScript自身没有模块化机制。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// a.js</span>
<span class="token keyword">function</span> <span class="token function">a</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// b.js</span>
<span class="token keyword">function</span> <span class="token function">b</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token comment">// c.js</span>
<span class="token keyword">function</span> <span class="token function">c</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
</code></pre></div><p>HTML加载:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>a.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>b.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>c.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="commonjs"><a href="#commonjs" class="header-anchor">#</a> CommonJS</h2> <p>根据<a href="http://javascript.ruanyifeng.com/nodejs/module.html" target="_blank" rel="noopener noreferrer">CommonJS规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，<strong>一个单独的文件就是一个模块</strong>。每一个模块都是一个单独的作用域，也就是说，在一个文件定义的变量（还包括函数和类），都是私有的，对其他文件是不可见的。</p> <p>一般应用于服务端(<code>Node.js</code>)，加载模块采用的是 <strong>同步方式(只有加载完成才能执行后面的操作)</strong>。同时，得力于<a href="https://github.com/substack/node-browserify" target="_blank" rel="noopener noreferrer">Browserify<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>这样的第三方工具，我们可以在浏览器端使用采用CommonJS规范的<code>js</code>文件。</p> <p><strong>CommonJS规范的3部分:</strong></p> <ul><li><p><code>require</code>: 模块引用</p></li> <li><p><code>exports</code>: 模块导出</p></li> <li><p><code>module</code>: 模块本身</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_a.js</span>
<span class="token keyword">var</span> $ <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">func</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ....</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> func
<span class="token comment">// or</span>
<span class="token comment">// exports指向module.exports，即exports === module.exports</span>
<span class="token comment">// exports = func</span>

<span class="token comment">// index.js</span>
<span class="token keyword">var</span> ma <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'module_a'</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>ma<span class="token punctuation">.</span><span class="token function">func</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="amd"><a href="#amd" class="header-anchor">#</a> AMD</h2> <p><a href="https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88)" target="_blank" rel="noopener noreferrer"><strong>Asynchronous Module Definition, 异步模块加载规范</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。一般应用在浏览器端, 与浏览器的异步加载模块的环境相适应。</p> <p>流行的浏览器端异步加载库<a href="https://requirejs.org" target="_blank" rel="noopener noreferrer">RequireJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>实现的就是AMD规范, 在推广中逐渐完善。</p> <p><strong>浏览器端<code>js</code>和服务器端<code>js</code>异同:</strong></p> <table><thead><tr><th>服务器端JS</th> <th>浏览器端JS</th></tr></thead> <tbody><tr><td>相同的代码需要多次执行</td> <td>代码需要从一个服务器端分发到多个客户端执行</td></tr> <tr><td>CPU和内存资源是瓶颈</td> <td>带宽是瓶颈</td></tr> <tr><td>加载时从磁盘中加载</td> <td>加载时需要通过网络加载</td></tr></tbody></table> <p><strong>AMD规范的3部分:</strong></p> <ul><li><p><code>define</code>: 定义模块</p></li> <li><p><code>return</code>: 输出接口</p></li> <li><p><code>require</code>: 加载模块</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_a.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">,</span> <span class="token string">'underscore'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    method1<span class="token punctuation">:</span> method1<span class="token punctuation">,</span>
    method2<span class="token punctuation">:</span> method2
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'module_a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">a</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  a<span class="token punctuation">.</span><span class="token function">method1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  a<span class="token punctuation">.</span><span class="token function">method2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- index.html --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/require.js<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data-main</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>js/index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="cmd"><a href="#cmd" class="header-anchor">#</a> CMD</h2> <p><a href="https://github.com/seajs/seajs/issues/242" target="_blank" rel="noopener noreferrer"><strong>Common Module Definition, 通用模块加载规范</strong><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。一般也是用在浏览器端。与<code>CommonJS</code>规范保持了很大的兼容性。</p> <p>由国内<strong>玉伯</strong>大神在开发<a href="https://seajs.github.io/seajs/docs/#docs" target="_blank" rel="noopener noreferrer">SeaJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>的时候提出来的。</p> <p><code>CMD</code>与<code>AMD</code>挺相近，二者区别如下：</p> <ul><li><p>对于依赖的模块<code>CMD</code>是延迟执行，而<code>AMD</code>是提前执行（不过 RequireJS 从 2.0 开始，也改成可以延迟执行。 ）</p></li> <li><p><code>CMD</code>推崇 <strong>as lazy as possible（依赖就近）</strong>，<code>AMD</code>推崇依赖前置。</p></li> <li><p><code>AMD</code>的API默认是一个当多个用，<code>CMD</code>严格的区分推崇职责单一，其每个<code>API</code>都简单纯粹。例如：<code>AMD</code>里<code>require</code>分全局的和局部的。<code>CMD</code>里面没有全局的<code>require</code>，提供<code>seajs.use()</code>来实现模块系统的加载启动。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_a.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> exports<span class="token punctuation">,</span> module</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'module_a.js执行'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>require<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// module_b.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require<span class="token punctuation">,</span> module<span class="token punctuation">,</span> exports</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'module_b.js执行'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>require<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>exports<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// index.js</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'module_a'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">var</span> b <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'module_b'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="umd"><a href="#umd" class="header-anchor">#</a> UMD</h2> <p><strong>Universal Module Definition, 通用模块规范</strong></p> <p>因为<code>AMD</code>，<code>CommonJS</code>规范是两种不一致的规范，虽然他们应用的场景也不太一致，但是人们仍然是期望有一种统一的规范来支持这两种规范。于是，<code>UMD</code>规范诞生了，以解决跨平台问题。</p> <p>客观来说，这个<code>UMD</code>规范看起来的确没有<code>AMD</code>和<code>CommonJS</code>规范简约。但是它支持<code>AMD</code>和<code>CommonJS</code>规范，同时还支持古老的全局模块模式。</p> <p><code>UMD</code>先判断是否支持<code>Node.js</code>的模块（<code>exports</code>）是否存在，存在则使用<code>Node.js</code>模块模式。再判断是否支持<code>AMD</code>（<code>define</code>是否存在），存在则使用<code>AMD</code>方式加载模块。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">root<span class="token punctuation">,</span> factory</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> define <span class="token operator">===</span> <span class="token string">'function'</span> <span class="token operator">&amp;&amp;</span> define<span class="token punctuation">.</span>amd<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// AMD</span>
      <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> exports <span class="token operator">===</span> <span class="token string">'object'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// Node, CommonJS-like</span>
      module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'jquery'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// Browser globals (root is window)</span>
      root<span class="token punctuation">.</span>returnExports <span class="token operator">=</span> <span class="token function">factory</span><span class="token punctuation">(</span>root<span class="token punctuation">.</span>jQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">$</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token function">myFunc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> myFunc<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="es6-module"><a href="#es6-module" class="header-anchor">#</a> ES6 Module</h2> <p>2015年6月，ES2015（即ECMAScript 6、ES6）正式发布。ES2015是该语言的一个显著更新，也是自2009年ES5标准确定后的第一个重大更新。</p> <p><strong>虽然ES2015提出了许多令人激动的新特性，但由于目前JavaScript的运行环境众多，对ECMAScript标准的支持程度也不一样。</strong></p> <p>一个模块就是一个独立的文件。该文件内部的所有变量，外部无法获取。</p> <ul><li><code>export</code>: 命令用于规定模块的对外接口。</li> <li><code>import</code>: 命令用于输入其他模块提供的功能。</li></ul> <p>ES6模块的设计思想是尽量的静态化，<strong>使得编译时就能确定模块的依赖关系，以及输入和输出的变量</strong>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// module_a.js</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">func1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">func2</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// module_b.js</span>
<span class="token keyword">export</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">func1</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ....</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">func2</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ....</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> func1<span class="token punctuation">,</span> func2 <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'module_a'</span>
<span class="token comment">// or</span>
<span class="token comment">// import * as ma from 'module_a'</span>

<span class="token keyword">import</span> mb <span class="token keyword">from</span> <span class="token string">'module_b'</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/note-paper/front-end/web-type.html" class="prev">Web类型</a></span> <span class="next"><a href="/note-paper/front-end/web-js-framework.html">JavaScript框架</a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/note-paper/assets/js/app.163bd82f.js" defer></script><script src="/note-paper/assets/js/2.982b397e.js" defer></script><script src="/note-paper/assets/js/10.1cfc15ca.js" defer></script>
  </body>
</html>
